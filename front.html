<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Homework Submission DApp</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6c63ff;
      --secondary: #4a44b5;
      --accent: #ff6584;
      --light: #f8f9ff;
      --dark: #2a2a3c;
      --success: #4ade80;
      --warning: #facc15;
      --danger: #f87171;
      --gray: #e2e8f0;
      --card-shadow: 0 10px 25px rgba(108, 99, 255, 0.15);
      --transition: all 0.3s ease;
      --creation: #f97316;
      --submission: #0ea5e9;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 2rem;
      display: flex;
      justify-content: center;
      align-items: center;
      color: var(--dark);
    }
    
    .container {
      background: var(--light);
      padding: 2.5rem;
      width: 100%;
      max-width: 900px;
      border-radius: 20px;
      box-shadow: var(--card-shadow);
      position: relative;
      overflow: hidden;
    }
    
    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
    }
    
    .header {
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
      padding-bottom: 1.5rem;
    }
    
    .header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 4px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      border-radius: 2px;
    }
    
    h1 {
      font-size: 2.2rem;
      color: var(--secondary);
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }
    
    .subtitle {
      color: #666;
      font-size: 1rem;
      max-width: 500px;
      margin: 0 auto;
      line-height: 1.6;
    }
    
    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 2rem;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .tab {
      padding: 12px 25px;
      border-radius: 30px;
      background: white;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      border: 2px solid var(--gray);
      box-shadow: 0 3px 8px rgba(0,0,0,0.05);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .tab.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
      box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3);
    }
    
    .section {
      margin-bottom: 2.5rem;
      background: white;
      padding: 1.8rem;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.03);
      border: 1px solid var(--gray);
      display: none;
    }
    
    .section.active {
      display: block;
    }
    
    .section-title {
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--secondary);
      margin-bottom: 1.5rem;
      font-size: 1.4rem;
      font-weight: 600;
    }
    
    .form-group {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    
    @media (min-width: 768px) {
      .form-group {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .input-group {
      position: relative;
      margin-bottom: 0.5rem;
    }
    
    .input-group i {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--primary);
      font-size: 1.1rem;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 15px 20px 15px 50px;
      border: 2px solid var(--gray);
      border-radius: 12px;
      font-size: 1rem;
      transition: var(--transition);
      background: #fafbff;
      font-family: 'Poppins', sans-serif;
    }
    
    textarea {
      min-height: 120px;
      padding: 15px;
    }
    
    select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236c63ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 1rem center;
      background-size: 1em;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
    }
    
    input::placeholder, select {
      color: #a0aec0;
    }
    
    button {
      width: 100%;
      padding: 15px;
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 4px 10px rgba(108, 99, 255, 0.3);
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(108, 99, 255, 0.4);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    .btn-submit {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
    }
    
    .btn-get {
      background: linear-gradient(135deg, #4ade80, #22c55e);
    }
    
    .btn-create {
      background: linear-gradient(135deg, #f97316, #ea580c);
    }
    
    .divider {
      display: flex;
      align-items: center;
      gap: 15px;
      margin: 2rem 0;
      color: var(--secondary);
      font-weight: 500;
    }
    
    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
    }
    
    #result {
      margin-top: 1.5rem;
      padding: 1.5rem;
      border-radius: 12px;
      background: #f0f7ff;
      border-left: 4px solid var(--primary);
      font-size: 1rem;
      line-height: 1.6;
      transition: var(--transition);
      display: none;
    }
    
    .result-header {
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--secondary);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .result-content {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 10px 15px;
    }
    
    .result-label {
      font-weight: 500;
      color: var(--secondary);
      display: flex;
      align-items: center;
      gap: 5px;
      min-width: 120px;
    }
    
    .result-value {
      word-break: break-all;
    }
    
    .footer {
      text-align: center;
      margin-top: 2rem;
      color: #718096;
      font-size: 0.9rem;
    }
    
    .footer a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }
    
    .loading {
      display: none;
      text-align: center;
      padding: 15px;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid rgba(108, 99, 255, 0.2);
      border-top: 3px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 25px;
      border-radius: 10px;
      background: white;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      transform: translateX(150%);
      transition: transform 0.3s ease;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 10px;
      border-left: 4px solid var(--success);
    }
    
    .notification.show {
      transform: translateX(0);
    }
    
    .notification.error {
      border-left-color: var(--danger);
    }
    
    .notification.info {
      border-left-color: var(--primary);
    }
    
    .submission-history {
      margin-top: 2rem;
      border-top: 1px solid var(--gray);
      padding-top: 1.5rem;
    }
    
    .history-title {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 1rem;
      color: var(--secondary);
    }
    
    .history-list {
      max-height: 300px;
      overflow-y: auto;
      padding-right: 10px;
    }
    
    .history-item {
      padding: 12px 15px;
      border-radius: 8px;
      background: #f8f9ff;
      margin-bottom: 10px;
      border-left: 3px solid var(--primary);
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: var(--transition);
      position: relative;
    }
    
    .history-item:hover {
      transform: translateX(5px);
      background: #edf2ff;
    }
    
    .history-id {
      font-weight: 600;
      color: var(--secondary);
      background: #e0e7ff;
      padding: 2px 8px;
      border-radius: 20px;
      font-size: 0.9rem;
    }
    
    .history-uri {
      font-size: 0.9rem;
      color: #666;
      max-width: 200px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .history-info {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
      margin: 0 15px;
    }
    
    .history-subject {
      font-size: 0.85rem;
      color: var(--primary);
      font-weight: 500;
    }
    
    .history-date {
      font-size: 0.8rem;
      color: #94a3b8;
    }
    
    .status-badge {
      padding: 3px 8px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }
    
    .status-approved {
      background: #dcfce7;
      color: #166534;
    }
    
    .status-pending {
      background: #fef9c3;
      color: #854d0e;
    }
    
    .id-display {
      background: #e0e7ff;
      padding: 10px 15px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 1.1rem;
      color: var(--secondary);
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }
    
    .id-display button {
      width: auto;
      padding: 8px 15px;
      background: var(--primary);
    }
    
    /* Transaction History Styles */
    .transaction-list {
      max-height: 400px;
      overflow-y: auto;
      padding-right: 10px;
    }
    
    .transaction-item {
      padding: 15px;
      border-radius: 10px;
      background: #f8f9ff;
      margin-bottom: 12px;
      display: flex;
      gap: 15px;
      border-left: 4px solid var(--creation);
      transition: var(--transition);
    }
    
    .transaction-item.submission {
      border-left-color: var(--submission);
    }
    
    .transaction-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #e0e7ff;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      color: var(--creation);
      font-size: 18px;
    }
    
    .transaction-item.submission .transaction-icon {
      background: #dbeafe;
      color: var(--submission);
    }
    
    .transaction-content {
      flex: 1;
    }
    
    .transaction-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .transaction-title {
      font-weight: 600;
      color: var(--dark);
      font-size: 1.1rem;
    }
    
    .transaction-type {
      padding: 3px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
      background: #e0e7ff;
      color: var(--creation);
    }
    
    .transaction-item.submission .transaction-type {
      background: #dbeafe;
      color: var(--submission);
    }
    
    .transaction-details {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 8px 15px;
      font-size: 0.9rem;
    }
    
    .transaction-label {
      font-weight: 500;
      color: var(--secondary);
      min-width: 100px;
    }
    
    .transaction-value {
      word-break: break-word;
    }
    
    .transaction-timestamp {
      font-size: 0.8rem;
      color: #94a3b8;
      margin-top: 8px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }
      
      .container {
        padding: 1.8rem;
      }
      
      .section {
        padding: 1.5rem;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .form-group {
        grid-template-columns: 1fr;
      }
      
      .history-item, .transaction-item {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .tabs {
        flex-direction: column;
      }
      
      .transaction-content {
        width: 100%;
      }
      
      .transaction-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      
      .transaction-details {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1><i class="fas fa-book-open"></i> Homework Submission DApp</h1>
      <p class="subtitle">Create homework assignments, submit solutions, and track all transactions</p>
    </div>
    
    <div class="tabs">
      <div class="tab active" onclick="switchTab('create')">
        <i class="fas fa-plus-circle"></i> Create Homework
      </div>
      <div class="tab" onclick="switchTab('submit')">
        <i class="fas fa-file-upload"></i> Submit Homework
      </div>
      <div class="tab" onclick="switchTab('view')">
        <i class="fas fa-search"></i> View Submissions
      </div>
      <div class="tab" onclick="switchTab('history')">
        <i class="fas fa-history"></i> Transaction History
      </div>
    </div>
    
    <!-- Create Homework Section -->
    <div class="section active" id="create-section">
      <h2 class="section-title"><i class="fas fa-plus-circle"></i> Create New Homework</h2>
      
      <div class="id-display">
        <div>
          <i class="fas fa-id-card"></i> 
          Homework ID: <span id="generated-id">HW-2023-001</span>
        </div>
        <button onclick="generateId()">
          <i class="fas fa-sync-alt"></i> Generate New ID
        </button>
      </div>
      
      <div class="input-group">
        <i class="fas fa-heading"></i>
        <input id="homework-title" placeholder="Homework Title" />
      </div>
      
      <div class="form-group">
        <div class="input-group">
          <i class="fas fa-book"></i>
          <select id="homework-subject">
            <option value="" disabled selected>Select Subject</option>
            <option value="math">Mathematics</option>
            <option value="science">Science</option>
            <option value="history">History</option>
            <option value="english">English</option>
            <option value="cs">Computer Science</option>
          </select>
        </div>
        
        <div class="input-group">
          <i class="fas fa-calendar"></i>
          <input id="homework-due-date" type="date" placeholder="Due Date" />
        </div>
      </div>
      
      <div class="input-group">
        <i class="fas fa-align-left"></i>
        <textarea id="homework-description" placeholder="Homework description and instructions..."></textarea>
      </div>
      
      <button class="btn-create" onclick="createHomework()">
        <i class="fas fa-save"></i> Create Homework Assignment
      </button>
    </div>
    
    <!-- Submit Homework Section -->
    <div class="section" id="submit-section">
      <h2 class="section-title"><i class="fas fa-file-upload"></i> Submit Homework</h2>
      
      <div class="form-group">
        <div class="input-group">
          <i class="fas fa-id-card"></i>
          <input id="homework-id" placeholder="Homework ID (e.g., HW-2023-001)" />
        </div>
        
        <div class="input-group">
          <i class="fas fa-link"></i>
          <input id="uri" placeholder="Homework URI (e.g., https://yourdomain.com/homework.pdf)" />
        </div>
      </div>
      
      <div class="form-group">
        <div class="input-group">
          <i class="fas fa-book"></i>
          <select id="subject">
            <option value="" disabled selected>Select Subject</option>
            <option value="math">Mathematics</option>
            <option value="science">Science</option>
            <option value="history">History</option>
            <option value="english">English</option>
            <option value="cs">Computer Science</option>
          </select>
        </div>
        
        <div class="input-group">
          <i class="fas fa-calendar"></i>
          <input id="due-date" type="date" placeholder="Due Date" />
        </div>
      </div>
      
      <button class="btn-submit" onclick="submitHomework()">
        <i class="fas fa-paper-plane"></i> Submit Homework
      </button>
    </div>
    
    <!-- View Submissions Section -->
    <div class="section" id="view-section">
      <h2 class="section-title"><i class="fas fa-search"></i> View Submissions</h2>
      
      <div class="form-group">
        <div class="input-group">
          <i class="fas fa-user-graduate"></i>
          <input id="address" placeholder="Student STX Address" />
        </div>
        
        <div class="input-group">
          <i class="fas fa-id-card"></i>
          <input id="search-id" placeholder="Homework ID" />
        </div>
      </div>
      
      <button class="btn-get" onclick="getSubmission()">
        <i class="fas fa-download"></i> Get Submission
      </button>
      
      <div id="result">
        <div class="result-header">
          <i class="fas fa-file-alt"></i> Submission Details
        </div>
        <div class="result-content">
          <div class="result-label"><i class="fas fa-id-card"></i> ID:</div>
          <div class="result-value" id="result-id">HW-2023-001</div>
          
          <div class="result-label"><i class="fas fa-link"></i> URI:</div>
          <div class="result-value" id="result-uri">https://example.com/homework.pdf</div>
          
          <div class="result-label"><i class="fas fa-book"></i> Subject:</div>
          <div class="result-value" id="result-subject">Mathematics</div>
          
          <div class="result-label"><i class="fas fa-clock"></i> Due Date:</div>
          <div class="result-value" id="result-due-date">2023-11-15</div>
          
          <div class="result-label"><i class="fas fa-calendar-check"></i> Submitted:</div>
          <div class="result-value" id="result-timestamp">2023-10-15 14:30:22</div>
          
          <div class="result-label"><i class="fas fa-id-card"></i> Address:</div>
          <div class="result-value" id="result-address">ST1PQHQKV0RJXZ...</div>
          
          <div class="result-label"><i class="fas fa-check-circle"></i> Status:</div>
          <div class="result-value" id="result-status">Pending Review</div>
        </div>
      </div>
      
      <div class="submission-history">
        <div class="history-title">
          <i class="fas fa-clock-rotate-left"></i>
          <h3>Recent Submissions</h3>
        </div>
        <div class="history-list" id="history-list">
          <!-- History items will be added here dynamically -->
        </div>
      </div>
    </div>
    
    <!-- Transaction History Section -->
    <div class="section" id="history-section">
      <h2 class="section-title"><i class="fas fa-history"></i> Transaction History</h2>
      
      <div class="transaction-filters">
        <div class="form-group">
          <div class="input-group">
            <i class="fas fa-filter"></i>
            <select id="filter-type" onchange="renderTransactionHistory()">
              <option value="all">All Transactions</option>
              <option value="creation">Homework Creation</option>
              <option value="submission">Homework Submission</option>
            </select>
          </div>
          
          <div class="input-group">
            <i class="fas fa-search"></i>
            <input id="search-transactions" placeholder="Search by ID or title..." oninput="renderTransactionHistory()" />
          </div>
        </div>
      </div>
      
      <div class="transaction-list" id="transaction-list">
        <!-- Transaction items will be added here dynamically -->
      </div>
    </div>
    
    <div class="footer">
      <p>Built with Blockchain Technology • Secure & Immutable • <a href="#" id="learn-more">Learn More</a></p>
    </div>
  </div>
  
  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i>
    <span id="notification-message">Your homework has been submitted successfully!</span>
  </div>

  <script>
    // Initialize data from localStorage
    let homeworkAssignments = JSON.parse(localStorage.getItem('homeworkAssignments')) || [
      { id: "HW-2023-001", title: "Algebra Homework", subject: "Mathematics", dueDate: "2023-11-15", description: "Solve quadratic equations and inequalities" },
      { id: "HW-2023-002", title: "Biology Report", subject: "Science", dueDate: "2023-11-18", description: "Write a report on cellular respiration" }
    ];
    
    let submissionHistory = JSON.parse(localStorage.getItem('submissionHistory')) || [
      { id: "HW-2023-001", uri: "https://drive.google.com/math-assignment.pdf", subject: "Mathematics", dueDate: "2023-11-15", timestamp: "2023-10-14 09:15:00", status: "approved" },
      { id: "HW-2023-002", uri: "https://drive.google.com/science-report.pdf", subject: "Science", dueDate: "2023-11-18", timestamp: "2023-10-13 14:22:00", status: "pending" },
      { id: "HW-2023-003", uri: "https://drive.google.com/history-essay.pdf", subject: "History", dueDate: "2023-11-10", timestamp: "2023-10-12 11:30:00", status: "approved" },
      { id: "HW-2023-004", uri: "https://drive.google.com/english-poem.pdf", subject: "English", dueDate: "2023-11-12", timestamp: "2023-10-11 16:45:00", status: "pending" }
    ];
    
    let transactionHistory = JSON.parse(localStorage.getItem('transactionHistory')) || [
      { type: 'creation', id: 'HW-2023-001', title: 'Algebra Homework', subject: 'Mathematics', timestamp: '2023-10-10 09:30:15' },
      { type: 'creation', id: 'HW-2023-002', title: 'Biology Report', subject: 'Science', timestamp: '2023-10-11 11:45:22' },
      { type: 'submission', id: 'HW-2023-001', uri: 'https://drive.google.com/math-assignment.pdf', subject: 'Mathematics', timestamp: '2023-10-14 09:15:00' },
      { type: 'submission', id: 'HW-2023-002', uri: 'https://drive.google.com/science-report.pdf', subject: 'Science', timestamp: '2023-10-13 14:22:00' }
    ];

    // DOM elements
    const resultDiv = document.getElementById("result");
    const resultId = document.getElementById("result-id");
    const resultUri = document.getElementById("result-uri");
    const resultSubject = document.getElementById("result-subject");
    const resultDueDate = document.getElementById("result-due-date");
    const resultTimestamp = document.getElementById("result-timestamp");
    const resultAddress = document.getElementById("result-address");
    const resultStatus = document.getElementById("result-status");
    const notification = document.getElementById("notification");
    const notificationMessage = document.getElementById("notification-message");
    const historyList = document.getElementById("history-list");
    const generatedIdSpan = document.getElementById("generated-id");
    const transactionList = document.getElementById("transaction-list");
    
    // Initialize the page
    function initPage() {
      renderSubmissionHistory();
      renderTransactionHistory();
      generateId();
      showNotification("Welcome to Homework Submission DApp! You can create and submit homework assignments.", false, 4000);
      
      // Set default due date to tomorrow
      const tomorrow = new Date();
      tomorrow.setDate(tomorrow.getDate() + 7); // Default due in 7 days
      document.getElementById("due-date").valueAsDate = tomorrow;
      document.getElementById("homework-due-date").valueAsDate = tomorrow;
    }
    
    // Save data to localStorage
    function saveData() {
      localStorage.setItem('homeworkAssignments', JSON.stringify(homeworkAssignments));
      localStorage.setItem('submissionHistory', JSON.stringify(submissionHistory));
      localStorage.setItem('transactionHistory', JSON.stringify(transactionHistory));
    }
    
    // Generate a unique homework ID
    function generateId() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const randomNum = Math.floor(1000 + Math.random() * 9000); // 4-digit random number
      
      const newId = `HW-${year}${month}${day}-${randomNum}`;
      generatedIdSpan.textContent = newId;
    }
    
    // Create a new homework assignment
    function createHomework() {
      const id = generatedIdSpan.textContent;
      const title = document.getElementById("homework-title").value;
      const subject = document.getElementById("homework-subject").value;
      const dueDate = document.getElementById("homework-due-date").value;
      const description = document.getElementById("homework-description").value;
      
      if (!title) {
        showNotification("Please enter a homework title", true);
        return;
      }
      
      if (!subject) {
        showNotification("Please select a subject", true);
        return;
      }
      
      if (!dueDate) {
        showNotification("Please select a due date", true);
        return;
      }
      
      if (!description) {
        showNotification("Please add a description", true);
        return;
      }
      
      // Add to homework assignments
      const newHomework = {
        id: id,
        title: title,
        subject: document.getElementById("homework-subject").options[document.getElementById("homework-subject").selectedIndex].text,
        dueDate: dueDate,
        description: description
      };
      
      homeworkAssignments.push(newHomework);
      
      // Add to transaction history
      const newTransaction = {
        type: 'creation',
        id: id,
        title: title,
        subject: document.getElementById("homework-subject").options[document.getElementById("homework-subject").selectedIndex].text,
        timestamp: new Date().toLocaleString()
      };
      
      transactionHistory.unshift(newTransaction);
      saveData();
      renderTransactionHistory();
      
      // Show success message
      showNotification(`Homework "${title}" created with ID: ${id}`, false);
      
      // Clear form and generate new ID
      document.getElementById("homework-title").value = '';
      document.getElementById("homework-subject").selectedIndex = 0;
      document.getElementById("homework-description").value = '';
      
      // Set default due date to next week
      const nextWeek = new Date();
      nextWeek.setDate(nextWeek.getDate() + 7);
      document.getElementById("homework-due-date").valueAsDate = nextWeek;
      
      generateId();
    }
    
    // Switch between tabs
    function switchTab(tabName) {
      // Hide all sections
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Deactivate all tabs
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected section and activate tab
      document.getElementById(`${tabName}-section`).classList.add('active');
      const tabIndex = 
        tabName === 'create' ? 1 : 
        tabName === 'submit' ? 2 : 
        tabName === 'view' ? 3 : 4;
      document.querySelector(`.tab:nth-child(${tabIndex})`).classList.add('active');
    }
    
    // Render submission history
    function renderSubmissionHistory() {
      if (!historyList) return;
      
      historyList.innerHTML = '';
      submissionHistory.slice(0, 5).forEach(item => {
        const historyItem = document.createElement('div');
        historyItem.className = 'history-item';
        historyItem.innerHTML = `
          <div>
            <span class="history-id">${item.id}</span>
          </div>
          <div class="history-info">
            <div class="history-uri">${item.uri}</div>
            <div class="history-subject">${item.subject}</div>
            <div class="history-date">${item.timestamp}</div>
          </div>
          <div class="status-badge ${item.status === 'approved' ? 'status-approved' : 'status-pending'}">
            ${item.status === 'approved' ? 'Approved' : 'Pending'}
          </div>
        `;
        historyList.appendChild(historyItem);
      });
    }
    
    // Render transaction history
    function renderTransactionHistory() {
      if (!transactionList) return;
      
      const filterType = document.getElementById('filter-type').value;
      const searchTerm = document.getElementById('search-transactions').value.toLowerCase();
      
      // Filter transactions
      const filteredTransactions = transactionHistory.filter(transaction => {
        const matchesType = filterType === 'all' || transaction.type === filterType;
        const matchesSearch = !searchTerm || 
          transaction.id.toLowerCase().includes(searchTerm) ||
          (transaction.title && transaction.title.toLowerCase().includes(searchTerm));
        return matchesType && matchesSearch;
      });
      
      transactionList.innerHTML = '';
      
      if (filteredTransactions.length === 0) {
        transactionList.innerHTML = `
          <div style="text-align: center; padding: 30px; color: #94a3b8;">
            <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 15px;"></i>
            <h3>No transactions found</h3>
            <p>Try changing your filters or create a new homework assignment</p>
          </div>
        `;
        return;
      }
      
      filteredTransactions.forEach(transaction => {
        const transactionItem = document.createElement('div');
        transactionItem.className = `transaction-item ${transaction.type}`;
        
        // Format details based on transaction type
        let detailsHTML = '';
        if (transaction.type === 'creation') {
          detailsHTML = `
            <div class="transaction-details">
              <div class="transaction-label">ID:</div>
              <div class="transaction-value">${transaction.id}</div>
              <div class="transaction-label">Subject:</div>
              <div class="transaction-value">${transaction.subject}</div>
              <div class="transaction-label">Due Date:</div>
              <div class="transaction-value">${transaction.dueDate || 'N/A'}</div>
            </div>
          `;
        } else {
          detailsHTML = `
            <div class="transaction-details">
              <div class="transaction-label">ID:</div>
              <div class="transaction-value">${transaction.id}</div>
              <div class="transaction-label">Subject:</div>
              <div class="transaction-value">${transaction.subject}</div>
              <div class="transaction-label">URI:</div>
              <div class="transaction-value">${transaction.uri}</div>
            </div>
          `;
        }
        
        transactionItem.innerHTML = `
          <div class="transaction-icon">
            <i class="${transaction.type === 'creation' ? 'fas fa-file-circle-plus' : 'fas fa-file-arrow-up'}"></i>
          </div>
          <div class="transaction-content">
            <div class="transaction-header">
              <div class="transaction-title">${transaction.title || 'Homework Submission'}</div>
              <div class="transaction-type">${transaction.type === 'creation' ? 'Creation' : 'Submission'}</div>
            </div>
            ${detailsHTML}
            <div class="transaction-timestamp">
              <i class="fas fa-clock"></i> ${transaction.timestamp}
            </div>
          </div>
        `;
        transactionList.appendChild(transactionItem);
      });
    }
    
    // Show notification
    function showNotification(message, isError = false, duration = 3000) {
      notificationMessage.textContent = message;
      notification.className = isError ? 
        'notification error show' : 'notification show';
      
      setTimeout(() => {
        notification.className = notification.className.replace(' show', '');
      }, duration);
    }
    
    // Submit homework function
    function submitHomework() {
      const homeworkId = document.getElementById("homework-id").value;
      const uri = document.getElementById("uri").value;
      const subject = document.getElementById("subject").value;
      const dueDate = document.getElementById("due-date").value;
      
      if (!homeworkId) {
        showNotification("Please enter a Homework ID", true);
        return;
      }
      
      if (!uri) {
        showNotification("Please enter a valid homework URI", true);
        return;
      }
      
      if (!subject) {
        showNotification("Please select a subject", true);
        return;
      }
      
      if (!dueDate) {
        showNotification("Please select a due date", true);
        return;
      }
      
      // Get the homework title for transaction history
      const homework = homeworkAssignments.find(hw => hw.id === homeworkId);
      const homeworkTitle = homework ? homework.title : 'Unknown Homework';
      
      // Add to submission history
      const newSubmission = {
        id: homeworkId,
        uri: uri,
        subject: document.getElementById("subject").options[document.getElementById("subject").selectedIndex].text,
        dueDate: dueDate,
        timestamp: new Date().toLocaleString(),
        status: "pending"
      };
      
      submissionHistory.unshift(newSubmission);
      
      // Add to transaction history
      const newTransaction = {
        type: 'submission',
        id: homeworkId,
        title: homeworkTitle,
        subject: document.getElementById("subject").options[document.getElementById("subject").selectedIndex].text,
        uri: uri,
        timestamp: new Date().toLocaleString()
      };
      
      transactionHistory.unshift(newTransaction);
      
      saveData();
      renderSubmissionHistory();
      renderTransactionHistory();
      
      // Show success message
      showNotification(`Homework ${homeworkId} submitted successfully!`, false);
      
      // Clear form
      document.getElementById("homework-id").value = '';
      document.getElementById("uri").value = '';
      document.getElementById("subject").selectedIndex = 0;
    }
    
    // Get submission function
    function getSubmission() {
      const address = document.getElementById("address").value;
      const homeworkId = document.getElementById("search-id").value;
      
      if (!address) {
        showNotification("Please enter a student address", true);
        return;
      }
      
      if (!homeworkId) {
        showNotification("Please enter a Homework ID", true);
        return;
      }
      
      // Find the submission in history
      const submission = submissionHistory.find(item => item.id === homeworkId);
      
      if (submission) {
        // Display results
        resultId.textContent = submission.id;
        resultUri.textContent = submission.uri;
        resultSubject.textContent = submission.subject;
        resultDueDate.textContent = submission.dueDate;
        resultTimestamp.textContent = submission.timestamp;
        resultAddress.textContent = address.substring(0, 12) + '...' + address.substring(address.length - 4);
        resultStatus.textContent = submission.status === 'approved' ? 'Approved' : 'Pending Review';
        resultDiv.style.display = 'block';
        
        showNotification(`Homework ${homeworkId} retrieved successfully!`, false);
      } else {
        showNotification(`No submission found for ID: ${homeworkId}`, true);
        resultDiv.style.display = 'none';
      }
    }
    
    // Demo functionality for "Learn More" link
    document.getElementById("learn-more").addEventListener("click", function(e) {
      e.preventDefault();
      showNotification("This DApp uses blockchain technology for secure homework submissions. All data is stored immutably on the blockchain.");
    });
    
    // Initialize the page when loaded
    window.onload = initPage;
  </script>
</body>
</html>